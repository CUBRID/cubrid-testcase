--This test is designed to exercise aggregates on a merge join. The select should return "33".  This needs to be run with the optimizer on.
autocommit off;
create class assoc (associd string, sect string);
create class name (lname string, nameid string);
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a1','01');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a2','02');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a3','03');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a4','04');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into assoc values ('a5','05');
insert into name values ('name001','a1');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name002','a2');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name003','a3');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name004','a4');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
insert into name values ('name005','a5');
create index i_assoc_associd on assoc(associd);
create index i_name_nameid on name(nameid);
commit work;
update statistics on assoc;
update statistics on name;
commit work;
select lname from assoc, name where lname = 'name001' and
	sect = '01' and nameid = associd;
select count(*) from assoc, name where lname = 'name001' and
	sect = '01' and nameid = associd;
drop assoc;
drop name;
commit work;
rollback;
