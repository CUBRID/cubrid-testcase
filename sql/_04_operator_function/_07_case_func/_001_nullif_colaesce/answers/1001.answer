===================================================
0
===================================================
1
===================================================
1
===================================================
1
===================================================
1
===================================================
1
===================================================
1
===================================================
sum(case when aa=1 then bb*1 when aa=3 then bb*2 when aa=7 then bb*3 end)    
6.0     

===================================================
sum(case when aa=(select aa from a where aa=1) then bb*1 when aa=(select aa from a where aa=3) then bb*2 when aa=(select aa from a where aa=7) then bb*3 end)    
6.0     

===================================================
(case when aa=1 then bb else (case when aa=2 then bb end) end)    
null     
null     
null     
null     
null     
1.0     

===================================================
case when aa is null  then 0 else aa end    
-1     
0     
0     
1     
3     
7     

===================================================
coalesce(aa, 0)    
-1     
0     
0     
1     
3     
7     

===================================================
nullif(aa, bb)    
null     
null     
null     
null     
3.0     
7.0     

===================================================
(case when aa=bb then null else aa end)    
null     
null     
null     
null     
3     
7     

===================================================
0
